__author__ = "Umut Can Kocaman"

import numpy as np
import pandas as pd
import requests
from bs4 import BeautifulSoup

imdb_url = "https://www.imdb.com/chart/top/"
r = requests.get(imdb_url)
soup = BeautifulSoup(r.content, "html.parser")
gelen_veri = soup.find_all("table", {"class" : "chart full-width"})
film_tablosu = (gelen_veri[0].contents)[len(gelen_veri[0].contents)-2]
film_tablosu = film_tablosu.find_all("tr")

film_isimleri = []
film_yillar = []
film_yillar2 = []
film_puanlari = []
film_sira = np.arange(1,251,1)

for film in film_tablosu:
    film_basliklari = film.find_all("td", {"class":"titleColumn"})
    film_ismi = film_basliklari[0].text
    film_ismi = film_ismi.replace("\n","")
    film_ismi = film_ismi.strip()
    yil = film_ismi[-6:]
    film_yillar.append(yil)
    film_ismi = film_ismi[5:len(film_ismi)-6]
    film_ismi = film_ismi.strip()
    film_isimleri.append(film_ismi)
    
for yil in film_yillar:
    yeni_yil = yil[1:5]
    film_yillar2.append(yeni_yil)

for film in film_tablosu:
    film_rating = film.find_all("td", {"class":"ratingColumn imdbRating"})
    film_puani = film_rating[0].text
    film_puani = film_puani.replace("\n","")
    film_puanlari.append(film_puani)

filmler = pd.DataFrame(film_sira, columns = ["sira"])
filmler["adi"] = film_isimleri
filmler["vizyon_tarihi"] = film_yillar2
